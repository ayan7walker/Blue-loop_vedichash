<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blue Loop - Vedic Hash Preprocessor</title><!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><circle cx='16' cy='16' r='14' fill='%230ea5e9' stroke='%230369a1' stroke-width='2'/><path d='M10 16 Q16 8 22 16 Q16 24 10 16' fill='none' stroke='white' stroke-width='2'/></svg>"><!-- Element SDK -->
  <script src="/_sdk/element_sdk.js"></script><!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=Space+Grotesk:wght@500;600;700&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'heading': ['Space Grotesk', 'sans-serif'],
            'body': ['Inter', 'sans-serif'],
          }
        }
      }
    }
  </script>
  <style>
    /* Base styles */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #1e293b;
    }
    ::-webkit-scrollbar-thumb {
      background: #0ea5e9;
      border-radius: 4px;
    }
    
    /* Animated gradient background */
    .gradient-bg {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
    }
    
    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    /* Floating particles effect */
    .particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      pointer-events: none;
    }
    
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: rgba(14, 165, 233, 0.3);
      border-radius: 50%;
      animation: float 20s infinite;
    }
    
    @keyframes float {
      0%, 100% { 
        transform: translateY(100%) translateX(0) scale(0);
        opacity: 0;
      }
      10% { opacity: 1; transform: scale(1); }
      90% { opacity: 1; }
      100% { 
        transform: translateY(-100%) translateX(100px) scale(0);
        opacity: 0;
      }
    }
    
    /* Loop animation for logo */
    .loop-icon {
      animation: loopSpin 8s linear infinite;
    }
    
    @keyframes loopSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Card glow effect */
    .card-glow {
      box-shadow: 
        0 0 60px rgba(14, 165, 233, 0.1),
        0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }
    
    /* Input focus glow */
    .input-glow:focus {
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.3);
    }
    
    /* Button shine effect */
    .btn-shine {
      position: relative;
      overflow: hidden;
    }
    
    .btn-shine::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      animation: shine 3s infinite;
    }
    
    @keyframes shine {
      0% { left: -100%; }
      50%, 100% { left: 100%; }
    }
    
    /* Loading spinner */
    .spinner {
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top: 3px solid white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Toast notification */
    .toast {
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    /* Social button hover */
    .social-btn {
      transition: all 0.3s ease;
    }
    
    .social-btn:hover {
      transform: translateY(-2px);
    }
    
    /* Password strength indicator */
    .strength-bar {
      transition: width 0.3s ease, background-color 0.3s ease;
    }
    
    /* Modal backdrop */
    .modal-backdrop {
      animation: fadeIn 0.2s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    /* Pulse animation for icons */
    .pulse-icon {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
  </style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full font-body"><!-- Main Container -->
  <div id="app-container" class="gradient-bg min-h-full w-full overflow-auto relative"><!-- Floating Particles -->
   <div class="particles" aria-hidden="true">
    <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
    <div class="particle" style="left: 20%; animation-delay: 2s;"></div>
    <div class="particle" style="left: 30%; animation-delay: 4s;"></div>
    <div class="particle" style="left: 40%; animation-delay: 6s;"></div>
    <div class="particle" style="left: 50%; animation-delay: 8s;"></div>
    <div class="particle" style="left: 60%; animation-delay: 10s;"></div>
    <div class="particle" style="left: 70%; animation-delay: 12s;"></div>
    <div class="particle" style="left: 80%; animation-delay: 14s;"></div>
    <div class="particle" style="left: 90%; animation-delay: 16s;"></div>
   </div><!-- Content Wrapper -->
   <div class="relative z-10 flex flex-col items-center justify-center min-h-full px-4 py-8"><!-- Login Card -->
    <div class="w-full max-w-md"><!-- Header Section -->
     <header class="text-center mb-8"><!-- App Logo & Title -->
      <div class="app-header flex items-center justify-center gap-3 mb-4"><!-- SVG Logo -->
       <div class="loop-icon">
        <svg width="48" height="48" viewbox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" class="drop-shadow-lg"><circle cx="24" cy="24" r="22" stroke="url(#logoGradient)" stroke-width="3" fill="none" /> <path d="M14 24 Q24 10 34 24 Q24 38 14 24" stroke="#0ea5e9" stroke-width="2.5" fill="none" /> <path d="M14 24 Q24 38 34 24" stroke="#38bdf8" stroke-width="2" fill="none" opacity="0.6" /> <circle cx="24" cy="24" r="4" fill="#0ea5e9" /> <defs>
          <lineargradient id="logoGradient" x1="0" y1="0" x2="48" y2="48">
           <stop offset="0%" stop-color="#0ea5e9" />
           <stop offset="100%" stop-color="#0369a1" />
          </lineargradient>
         </defs>
        </svg>
       </div>
       <div class="text-left">
        <h1 id="team-name" class="font-heading text-2xl md:text-3xl font-bold text-white tracking-tight"> ∞ Blue Loop</h1>
        <p id="tagline" class="text-sky-400 text-sm md:text-base font-light italic">Code the Innovation, Loop the Future</p>
       </div>
      </div>
      <h2 id="app-name" class="font-heading text-lg md:text-xl font-semibold text-slate-300">Vedic Hash Preprocessor</h2>
     </header><!-- Login Card -->
     <main class="card-glow bg-slate-800/80 backdrop-blur-xl rounded-2xl p-6 md:p-8 border border-slate-700/50"><!-- Card Header -->
      <div class="text-center mb-6">
       <h3 class="text-xl font-semibold text-white mb-2">CyberGuard</h3>
       <p class="text-slate-400 text-sm">Sign in to continue</p>
      </div><!-- Login Form -->
      <form id="login-form" class="space-y-5" novalidate><!-- Username/Email Field -->
       <div class="space-y-2"><label for="username" class="block text-sm font-medium text-slate-300"> Username / Email </label>
        <div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">
          <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" /> <circle cx="12" cy="7" r="4" />
          </svg></span> <input type="text" id="username" name="username" class="input-glow w-full bg-slate-900/50 border border-slate-600 rounded-xl py-3 pl-11 pr-4 text-white placeholder-slate-500 focus:outline-none focus:border-sky-500 transition-all duration-200" placeholder="Enter username" autocomplete="username" required>
        </div>
        <p id="username-error" class="text-red-400 text-xs hidden">Please enter your username or email</p>
       </div><!-- Password Field -->
       <div class="space-y-2"><label for="password" class="block text-sm font-medium text-slate-300"> Password </label>
        <div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">
          <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2" /> <path d="M7 11V7a5 5 0 0 1 10 0v4" />
          </svg></span> <input type="password" id="password" name="password" class="input-glow w-full bg-slate-900/50 border border-slate-600 rounded-xl py-3 pl-11 pr-12 text-white placeholder-slate-500 focus:outline-none focus:border-sky-500 transition-all duration-200" placeholder="Enter your password" autocomplete="current-password" required> <!-- Show/Hide Password Toggle --> <button type="button" id="toggle-password" class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-sky-400 transition-colors p-1" aria-label="Toggle password visibility">
          <svg id="eye-icon" width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" /> <circle cx="12" cy="12" r="3" />
          </svg>
          <svg id="eye-off-icon" width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="hidden"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" /> <line x1="1" y1="1" x2="23" y2="23" />
          </svg></button>
        </div>
        <p id="password-error" class="text-red-400 text-xs hidden">Please enter your password</p>
       </div><!-- Remember Me & Forgot Password -->
       <div class="flex items-center justify-between flex-wrap gap-2"><label class="flex items-center gap-2 cursor-pointer group"> <input type="checkbox" id="remember-me" class="w-4 h-4 rounded border-slate-600 bg-slate-900/50 text-sky-500 focus:ring-sky-500 focus:ring-offset-0 cursor-pointer"> <span class="text-sm text-slate-400 group-hover:text-slate-300 transition-colors">Keep me logged in</span> </label> <button type="button" id="forgot-password-btn" class="text-sm text-sky-400 hover:text-sky-300 transition-colors hover:underline"> Forgot Password? </button>
       </div><!-- Login Button --> <button type="submit" id="login-btn" class="btn-shine w-full bg-gradient-to-r from-sky-500 to-blue-600 hover:from-sky-400 hover:to-blue-500 text-white font-semibold py-3 rounded-xl transition-all duration-300 shadow-lg shadow-sky-500/25 hover:shadow-sky-500/40 flex items-center justify-center gap-2"> <span id="login-btn-text">Sign In</span>
        <div id="login-spinner" class="spinner hidden"></div></button> <!-- General Error Message -->
       <p id="general-error" class="text-red-400 text-sm text-center hidden"></p>
      </form><!-- Divider -->
      <div class="relative my-6">
       <div class="absolute inset-0 flex items-center">
        <div class="w-full border-t border-slate-600/50"></div>
       </div>
     <!--   <div class="relative flex justify-center text-sm"><span class="px-4 bg-slate-800 text-slate-500">or continue with</span>
       </div> -->
	   
      </div> 
	  
	  <!--

	  Social Login Buttons 
	  
      <div class="grid grid-cols-2 gap-3"><!-- Google Login  <button type="button" class="social-btn flex items-center justify-center gap-2 bg-white hover:bg-gray-100 text-gray-700 font-medium py-3 px-4 rounded-xl transition-all duration-200 shadow-md" onclick="showToast('Google login will be integrated with backend', 'info')">
        <svg width="20" height="20" viewbox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" /> <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" /> <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" /> <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
        </svg><span class="hidden sm:inline">Google</span> </button> <!-- GitHub Login  <button type="button" class="social-btn flex items-center justify-center gap-2 bg-slate-900 hover:bg-slate-950 text-white font-medium py-3 px-4 rounded-xl transition-all duration-200 shadow-md border border-slate-700" onclick="showToast('GitHub login will be integrated with backend', 'info')">
        <svg width="20" height="20" viewbox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
        </svg><span 
	
      </div> Sign Up Link --> 
	  
      <p class="text-center text-slate-400 text-sm mt-6">Don't have an account? <button type="button" class="text-sky-400 hover:text-sky-300 font-medium transition-colors hover:underline" onclick="showToast('Registration page coming soon!', 'info')"> Sign Up </button></p>
     </main><!-- Footer -->
     <footer class="text-center mt-8 space-y-3">
      <div class="flex items-center justify-center gap-4 text-sm"><button type="button" class="text-slate-500 hover:text-sky-400 transition-colors" onclick="showModal('privacy')"> Privacy Policy </button> <span class="text-slate-600">•</span> <button type="button" class="text-slate-500 hover:text-sky-400 transition-colors" onclick="showModal('terms')"> Terms &amp; Conditions </button>
      </div>
      <p id="copyright-text" class="text-slate-600 text-xs">© 2024 Blue Loop. All rights reserved.</p>
     </footer> 
    </div>

	
	
	
   </div><!-- Toast Container -->
   <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div><!-- Forgot Password Modal -->
   <div id="forgot-password-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-backdrop absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal('forgot-password-modal')"></div>
    <div class="relative flex items-center justify-center min-h-full p-4">
     <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border border-slate-700 shadow-2xl relative z-10">
      <div class="flex items-center justify-between mb-6">
       <h4 class="text-lg font-semibold text-white">Reset Password</h4><button type="button" class="text-slate-400 hover:text-white transition-colors" onclick="closeModal('forgot-password-modal')" aria-label="Close modal">
        <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18" /> <line x1="6" y1="6" x2="18" y2="18" />
        </svg></button>
      </div>
      <p class="text-slate-400 text-sm mb-6">Choose how you'd like to reset your password:</p>
      <div class="space-y-3"><!-- OTP via Phone --> <button type="button" class="w-full flex items-center gap-3 bg-slate-700/50 hover:bg-slate-700 text-white p-4 rounded-xl transition-all duration-200 border border-slate-600 hover:border-sky-500" onclick="showResetOption('phone')">
        <div class="w-10 h-10 rounded-full bg-sky-500/20 flex items-center justify-center">
         <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="#0ea5e9" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
         </svg>
        </div>
        <div class="text-left">
         <p class="font-medium">Reset via Phone (OTP)</p>
         <p class="text-xs text-slate-400">Receive a verification code</p>
        </div></button> <!-- ID Upload --> <button type="button" class="w-full flex items-center gap-3 bg-slate-700/50 hover:bg-slate-700 text-white p-4 rounded-xl transition-all duration-200 border border-slate-600 hover:border-sky-500" onclick="showResetOption('upload')">
        <div class="w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center">
         <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2"><rect x="3" y="4" width="18" height="16" rx="2" /> <circle cx="9" cy="10" r="2" /> <path d="M15 8h2" /> <path d="M15 12h2" /> <path d="M7 16h10" />
         </svg>
        </div>
        <div class="text-left">
         <p class="font-medium">Reset via ID Upload</p>
         <p class="text-xs text-slate-400">Upload a valid identification</p>
        </div></button>
      </div>
     </div>
    </div>
   </div><!-- Phone OTP Modal -->
   <div id="phone-otp-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-backdrop absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal('phone-otp-modal')"></div>
    <div class="relative flex items-center justify-center min-h-full p-4">
     <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border border-slate-700 shadow-2xl relative z-10">
      <div class="flex items-center justify-between mb-6">
       <h4 class="text-lg font-semibold text-white">Phone Verification</h4><button type="button" class="text-slate-400 hover:text-white transition-colors" onclick="closeModal('phone-otp-modal')" aria-label="Close modal">
        <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18" /> <line x1="6" y1="6" x2="18" y2="18" />
        </svg></button>
      </div>
      <form id="otp-form" class="space-y-4">
       <div><label for="phone-number" class="block text-sm font-medium text-slate-300 mb-2">Phone Number</label> <input type="tel" id="phone-number" class="input-glow w-full bg-slate-900/50 border border-slate-600 rounded-xl py-3 px-4 text-white placeholder-slate-500 focus:outline-none focus:border-sky-500 transition-all duration-200" placeholder="+91 98765 43210">
       </div>
       <div id="otp-input-section" class="hidden"><label class="block text-sm font-medium text-slate-300 mb-2">Enter OTP</label>
        <div class="flex gap-2 justify-center"><input type="text" maxlength="1" class="otp-digit w-12 h-12 text-center text-xl font-bold bg-slate-900/50 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-sky-500" data-index="0"> <input type="text" maxlength="1" class="otp-digit w-12 h-12 text-center text-xl font-bold bg-slate-900/50 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-sky-500" data-index="1"> <input type="text" maxlength="1" class="otp-digit w-12 h-12 text-center text-xl font-bold bg-slate-900/50 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-sky-500" data-index="2"> <input type="text" maxlength="1" class="otp-digit w-12 h-12 text-center text-xl font-bold bg-slate-900/50 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-sky-500" data-index="3"> <input type="text" maxlength="1" class="otp-digit w-12 h-12 text-center text-xl font-bold bg-slate-900/50 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-sky-500" data-index="4"> <input type="text" maxlength="1" class="otp-digit w-12 h-12 text-center text-xl font-bold bg-slate-900/50 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-sky-500" data-index="5">
        </div>
        <p class="text-center text-slate-400 text-xs mt-2">Demo OTP: 123456</p>
       </div><button type="button" id="send-otp-btn" class="w-full bg-sky-500 hover:bg-sky-400 text-white font-semibold py-3 rounded-xl transition-all duration-200" onclick="sendOTP()"> Send OTP </button> <button type="button" id="verify-otp-btn" class="hidden w-full bg-emerald-500 hover:bg-emerald-400 text-white font-semibold py-3 rounded-xl transition-all duration-200" onclick="verifyOTP()"> Verify OTP </button>
      </form>
     </div>
    </div>
   </div><!-- ID Upload Modal -->
   <div id="upload-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-backdrop absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal('upload-modal')"></div>
    <div class="relative flex items-center justify-center min-h-full p-4">
     <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border border-slate-700 shadow-2xl relative z-10">
      <div class="flex items-center justify-between mb-6">
       <h4 class="text-lg font-semibold text-white">Upload Identification</h4><button type="button" class="text-slate-400 hover:text-white transition-colors" onclick="closeModal('upload-modal')" aria-label="Close modal">
        <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18" /> <line x1="6" y1="6" x2="18" y2="18" />
        </svg></button>
      </div>
      <form id="upload-form" class="space-y-4">
       <div><label class="block text-sm font-medium text-slate-300 mb-2">Upload ID Document</label>
        <div id="drop-zone" class="border-2 border-dashed border-slate-600 rounded-xl p-8 text-center hover:border-sky-500 transition-colors cursor-pointer" onclick="document.getElementById('file-input').click()">
         <svg class="mx-auto mb-3 text-slate-400" width="40" height="40" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /> <polyline points="17 8 12 3 7 8" /> <line x1="12" y1="3" x2="12" y2="15" />
         </svg>
         <p class="text-slate-400 text-sm">Drag &amp; drop or click to upload</p>
         <p class="text-slate-500 text-xs mt-1">PNG, JPG up to 5MB</p><input type="file" id="file-input" class="hidden" accept="image/*" onchange="handleFileUpload(this)">
        </div>
        <p id="file-name" class="text-sky-400 text-sm mt-2 hidden"></p>
       </div><button type="button" id="submit-upload-btn" class="w-full bg-emerald-500 hover:bg-emerald-400 text-white font-semibold py-3 rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed" onclick="submitUpload()" disabled> Submit for Verification </button>
       <p class="text-slate-500 text-xs text-center">Your ID will be reviewed within 24-48 hours</p>
      </form>
     </div>
    </div>
   </div><!-- Policy Modal -->
   <div id="policy-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-backdrop absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal('policy-modal')"></div>
    <div class="relative flex items-center justify-center min-h-full p-4">
     <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-lg max-h-96 border border-slate-700 shadow-2xl relative z-10 flex flex-col">
      <div class="flex items-center justify-between mb-4">
       <h4 id="policy-title" class="text-lg font-semibold text-white">Policy</h4><button type="button" class="text-slate-400 hover:text-white transition-colors" onclick="closeModal('policy-modal')" aria-label="Close modal">
        <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18" /> <line x1="6" y1="6" x2="18" y2="18" />
        </svg></button>
      </div>
      <div id="policy-content" class="text-slate-300 text-sm overflow-y-auto flex-1 pr-2"><!-- Content loaded dynamically -->
      </div>
     </div>
    </div>
   </div><!-- Success Modal -->
   <div id="success-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-backdrop absolute inset-0 bg-black/60 backdrop-blur-sm"></div>
    <div class="relative flex items-center justify-center min-h-full p-4">
     <div class="bg-slate-800 rounded-2xl p-8 w-full max-w-sm border border-slate-700 shadow-2xl relative z-10 text-center">
      <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-emerald-500/20 flex items-center justify-center">
       <svg width="40" height="40" viewbox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="3"><polyline points="20 6 9 17 4 12" />
       </svg>
      </div>
      <h4 class="text-xl font-semibold text-white mb-2">Login Successful!</h4>
      <p class="text-slate-400 mb-6">Welcome back! Redirecting you to the dashboard...</p>
      <div class="flex items-center justify-center gap-2 text-sky-400">
       <div class="spinner border-sky-400 border-t-transparent"></div><span class="text-sm">Loading dashboard...</span>
      </div>
     </div>
    </div>
   </div>
  </div>
  

  <script>

    // ============================================
    // SAFE TOKEN CHECK FUNCTION (FIXED)
    // ============================================
    
    function isValidToken(token) {
        return (
            token &&
            token !== "undefined" &&
            token !== "null" &&
            token.trim() !== ""
        );
    }
    
    
    // ============================================
    // AUTO REDIRECT IF ALREADY LOGGED IN (FIXED)
    // ============================================
    
    const existingToken = localStorage.getItem("token");
    
    if (isValidToken(existingToken)) {
        window.location.href = "/welcome.html";
    }
    
    
    // ============================================
    // Backend API Base URL
    // ============================================
    
    const API_BASE = "/api"; // FIXED (no hardcoded localhost)
    
    
    // ============================================
    // DOM Elements
    // ============================================
    
    const loginForm = document.getElementById("login-form");
    
    const usernameInput = document.getElementById("username");
    const passwordInput = document.getElementById("password");
    
    const loginBtn = document.getElementById("login-btn");
    const loginBtnText = document.getElementById("login-btn-text");
    const loginSpinner = document.getElementById("login-spinner");
    
    const usernameError = document.getElementById("username-error");
    const passwordError = document.getElementById("password-error");
    const generalError = document.getElementById("general-error");
    
    
    // ============================================
    // LOGIN SUBMIT
    // ============================================
    
    loginForm.addEventListener("submit", async function (e) {
    
        e.preventDefault();
    
        hideErrors();
    
        const username = usernameInput.value.trim();
        const password = passwordInput.value.trim();
    
        let hasError = false;
    
        if (!username) {
            showError(usernameError, "Username required");
            hasError = true;
        }
    
        if (!password) {
            showError(passwordError, "Password required");
            hasError = true;
        }
    
        if (hasError) return;
    
        setLoading(true);
    
        try {
    
            const response = await fetch(`${API_BASE}/login`, {
    
                method: "POST",
    
                headers: {
                    "Content-Type": "application/json"
                },
    
                body: JSON.stringify({
                    username,
                    password
                })
    
            });
    
            const data = await response.json();
    
            setLoading(false);
    
            if (response.ok && isValidToken(data.token)) {
    
                // STORE TOKEN SAFELY
                localStorage.setItem("token", data.token);
    
                showSuccess();
    
                setTimeout(() => {
                    window.location.href = "/welcome.html";
                }, 1000);
    
            }
            else {
    
                showError(
                    generalError,
                    data.message || "Login failed"
                );
    
            }
    
        }
        catch (error) {
    
            setLoading(false);
    
            showError(
                generalError,
                "Cannot connect to server"
            );
    
            console.error(error);
    
        }
    
    });
    
    
    // ============================================
    // HELPER FUNCTIONS
    // ============================================
    
    function showError(element, message){
    
        element.textContent = message;
        element.classList.remove("hidden");
    
    }
    
    function hideErrors(){
    
        usernameError.classList.add("hidden");
        passwordError.classList.add("hidden");
        generalError.classList.add("hidden");
    
    }
    
    function setLoading(state){
    
        loginBtn.disabled = state;
        loginSpinner.classList.toggle("hidden", !state);
    
        loginBtnText.textContent =
            state ? "Signing in..." : "Sign In";
    
    }
    
    function showSuccess(){
    
        document
        .getElementById("success-modal")
        .classList.remove("hidden");
    
    }
    
    
    // ============================================
    // PASSWORD TOGGLE
    // ============================================
    
    const togglePasswordBtn =
        document.getElementById("toggle-password");
    
    if(togglePasswordBtn){
    
        togglePasswordBtn.addEventListener(
            "click",
            function(){
    
                const isPassword =
                    passwordInput.type === "password";
    
                passwordInput.type =
                    isPassword ? "text" : "password";
    
            }
        );
    
    }
    
    
    // ============================================
    // SIGNUP REDIRECT
    // ============================================
    
    const signupBtn = document.querySelector(
        "button[onclick*='Registration page coming soon']"
    );
    
    if(signupBtn){
    
        signupBtn.onclick = function(){
            window.location.href = "/signup.html";
        }
    
    }
    
    </script>
  
  
 </body>
</html>